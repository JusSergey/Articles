<html><head><title>ALK :: Просто так :: Арендованный сервер от hcenter.ru и хостинг в Германии</title>
</head>
<body bgcolor="white" text="black">
<a href="http://counter.rambler.ru/top100/"><img align="left" src="http://counter.rambler.ru/top100.cnt?160852" alt="Rambler's Top100 Service" width=1 height=1 border=0></a>
Этот текст распечатан с домашней странички Андрея Калинина 
(<a href="http://www.kalinin.ru">www.kalinin.ru</a>).<br>
Оригинал статьи находится по этому адресу: <a href="http://www.kalinin.ru/etc/30_11_08.shtml">http://www.kalinin.ru/etc/30_11_08.shtml</a><br>
<hr>
<br>

<h1>Арендованный сервер от hcenter.ru и хостинг в Германии
</h1>
<p align="right">30.11.08</p>
 
<p align="justify"> Началось всё с того, что я решил попробовать арендовать сервер в
Германии. Я слышал много положительных отзывов в пользу такого мнения, да
и Тутубалин в <a href="http://www.rukv.ru/runet-2008.html">последнем своём исследовании доменов</a> обнаружил значительную миграцию
проектов в сторону Германии и США. И, в общем-то, если смотреть
поверхностно, казалось что немецкие предложения очень достойны: 
</p>
<ul>
 <li>ping из Москвы порядка 80ms</li>
 <li>цена аренды меньше стоимости размещения серверов в московских
   дата-центров.</li> 
 <li>конфигурация серверов, на первый взгляд, вполне приличная: хорошие
   процессоры, много памяти. </li>
</ul>

<p align="justify">Соответственно, я попробовал заказать сервер в hcenter.ru (как
окзалось позже, реселлер keyweb.de/keyweb.ru) и теперь хочу описать
это приключение для тех, кто только собирается, так же как и я месяц
назад, попрбовать на вкус немецкий хочтинг. Кому много читать 
неинтересно, вот сразу выясненные мною факты и полученные выводы: </p>
<ul>
 <li>комплектующие, из которых собираются сервера немецких дешёвых
   хостингов, не просто дешёвые, а очень дешёвые и очень
   плохие. Если можно где-то найти чуть подешевле и значительно хуже,
   они найдут и будут использовать. Как следствие, в массе своей используются не серверные
   платформы, а просто дешёвые рабочие станции. В моём случае
   показательны печально известная сетевая карта Realtek 8139 и жёсткие диски Samsung.
   И такая ситуация не только в keyweb, а вообще практически везде,
   чтобы это понять достаточно внимательно читать предложения. </li>

 <li>русскоязычный саппорт ресселеров, находящийся между клиентом и
   дата-центром выполняет роль белого шума на линии. То есть, несмотря
   на то, что именно они получают с клиента деньги, дальше они не
   берут на себя никакой ответственности, и не могут ничего сделать,
   по-детски ссылаясь на условия дата-центра. К примеру, в
   случае невыполнения обязательств они не могут вернуть деньги,
   мотивируя это тем, что дата-центр не практикует moneyback. Хотя,
   казалось бы, причём здесь дата-центр, когда деньги несли ресселеру
   и ресселер не говорил, что он ресселер?</li>

 <li>дополнительные деньги вытягиваются за счёт технической
   поддержки. Перезагрузить сервер они, наверное, смогут
   бесплатно, но сделать что-нибудь большее &mdash; только за
   деньги. Буквально, подцепить клавиаутуру с монитором к серверу и
   нажать во время загрузки на одну клавишу уже оплачивается как час
   работы специалиста. Это то, что в нормальных московских
   дата-центрах просто имеется в виду и никогда не оговаривается. </li>
</ul>

<p align="justify">Выводы здесь простые: лично я больше с ресселерами иметь дела не хочу,
кустарных серверов боюсь. </p>

<p align="justify">Общая статистика общения с hcenter'ом следующая: </p>
<ul>
  <li>переставляли операционную систему: 4 раза. </li>
 <li>из них её поставили так, как я просил: 1 раз (однако сеть не работала,
   но я этого требования явно не указал, так что зачту за корректную
   установку) </li>
 <li>рейд &laquo;асилили&raquo; собрать при установке два раза. </li>
 <li>FreeBSD 6.3 ставили один раз, FreeBSD 7.0 два раза, CentOS 5.x &mdash; один
   раз.</li> 
 <li>переписка состоит из ~40 писем с каждой стороны. Стоит признать,
   что время реакции на письма со стороны саппорта удовлетворительная. </li>
 <li>дополнительные деньги с меня требовали два раза (я не дал)</li>
 <li>я предложил дать дополнительных денег один раз (они не взяли)</li>
</ul>

<p align="justify">Общие итоги: поставить на сервер то, что я требовал изначально
оказалось невозможно, денег при этом вернуть обратно нельзя. CentOS со
мною несовместим, работать я с ним на этом сервере и у этого
провайдера не хочу и не буду. То есть, по факту победа за hcenter'ом,
но считаю что я свою партию тоже провёл достойно и очков набрал
достаточно. </p>

<p align="justify">Вообще же, если кто-нибудь вам будет рекомендовать hcenter или keyweb,
да и вообще немецкий хостинг, начните в нём сомневаться. Может он вам
зла желает?</p>

<p align="justify">Теперь подробнее о том, как этот месяц прошёл. Ей-богу, было
весело, с саппортом hcenter.ru скучать не пришлось и после каждого их
письма я дико веселился. </p>

<h2>Изначальная диспозиция</h2>

<p align="justify">Я подбирал себе сервер исходя из следующих предпочтений: </p>
<ul>
 <li>возможность установить туда FreeBSD.</li>
 <li>оплата через Webmoney, порядка 4000-4500 рублей в месяц.</li>
 <li>минимальная конфигурация: два диска по 160ГБ, процессор с двумя
 ядрами и  2ГБ памяти. </li>
</ul>

<p align="justify">Соответственно, я хотел получить сервер с FreeBSD 6.3, софтверным зеркалом
из двух дисков (gmirror), разбиение диска по моим указаниям, всё остальное
я собирался сделать сам. hcenter.ru активно предлагал себя на разных
форумах, указывал что может поставить FreeBSD и т.д. Мне понравилась
вот эта конфигурация: </p>

<p align="justify">
Core2Duo 2 x 1,8 ГГц /4096 Мб RAM / 2x320Гб HDD /2 IP<br/>
(кстати, за месяц нашего общения эта конфигурация за ту же цену
подросла до Core2Duo 2 x 2,66 ГГц /4096 Мб RAM / 2x500Гб HDD /2 IP)</p>

<p align="justify">Замечу, что уже конфигурация странно записана &mdash; я долго ломал
голову, 2x1,8 &mdash; подчёркивается, что два ядра, или поставили два
процессора? Оказалось, что это всего-лишь так обозначется наличие двух
ядер. </p>

<p align="justify">Стоил сервер 4000 рублей за установку и 3700 в месяц. Я надеялся, что
большая цена установки как раз и подразумевает тщательность при
подготовке сервера, оказалось что это не так. </p>

<h2>Заказ сервера</h2>

<p align="justify">30 октября я написал письмо с вопросом об возможности аренды сервера. В ответ я
моментально получил письмо от робота, на английском и нечитаемом русском (текст был записан в
неправильной кодировке) языках, чтобы я подтвердил своё желание
доставить им почтовое сообщение. Тут надо сказать, что я на такие
письма никогда не реагирую и считаю это верным признаком того, что письмо от
меня принимать не хотят. Понятно, что они так борятся со спамом, но
ведь я уже
написал письмо с предложением денег, что ещё от меня можно требовать?
Но, почему-то рука дрогнула, я решил что это какая-то студенческая
контора, а студенты могут плохо понимать к чему приводят те или иные
действия, но быстро учатся. Поэтому, можно на студентов посмотреть,
почему нет? Так что моя первая и главная
ошибка была именно здесь: как только я получил ответ от робота, нужно
было общение с hcenter.ru закончить.</p>

<p align="justify">Второй культурный  шок я испытал, когда мне пришёл ответ из службы технической
поддержки hcenter.ru. Для переписки они использовали адрес бесплатной
почтовой службы в домене list.ru! Тут я тоже себя успокоил, всё-таки
письма они писали без грубых ошибок, разум вроде бы присутствовал, да и многого
мне от них всё равно не надо. Поэтому  взял себя в руки и продолжил договариваться. </p>

<p align="justify">В сторону сказать, использование list.ru они оправдывали смешно: </p>
<blockquote>
Это связано с тем, что на почтовом сервере используется система серых списков и иногда до некоторых e-mail письма не доходят.
</blockquote>

<p align="justify">Ну, то есть, &laquo;мы не умеем настраивать почтовую систему так, чтобы она
не теряла почту, а спам при этом всё-таки фильтровала, поэтому для себя
ипользуем mail.ru&raquo;. Мне, как одному из авторов SpamTest (Kaspersky
Anti-Spam, который используется на mail.ru) это было, конечно,
приятно.</p> 

<p align="justify">При этом в их форуме обычного хостинга есть такое: человек 
<a href="http://forum.hcenter.ru/index.php?showtopic=639&mode=linearplus"  rel="nofollow">спрашивает</a> &laquo;Куда
дели SpamAssassin?&raquo; а ему отвечают, что спам из-за нагрузки на сервер
фильтроваться не будет и 
<a href="http://faq.hcenter.ru/index.php?subaction=showfull&id=1214067925&archive=&start_from=&ucat=1"  rel="nofollow">советуют пользоваться gmail'ом!</a>
Я считаю, это
замечательный ответ техподдержки. </p>

<p align="justify">В общем, 31-го числа я оплатил сервер и стал ждать. Спустя 10 дней, то
есть вечером 10-го
ноября (я всё думал &mdash; какие 5 рабочих дней на установку они имеют в
виду, русские или немецкие?) я получил пароль рута и адрес своего нового сервера. </p>

<h2>FreeBSD 6.3, знакомство с сервером</h2>

<p align="justify">Ура! Вот я и в Германии. Впрочем, радость быстро омрачилась сразу двумя
фактами: </p>
<ul>
<li>сетевая карта Realtek 8139, жёсткие диски Samsung. Я вообще не
 предполагал, что такое можно поставить в сервер, поэтому не уточнил
 используемых комплектующих при заказе сервера. С дисками всё проще, они будут в зеркале, поэтому
 в смысле надёжности это не очень страшно; а то что производительность
 низкая &mdash; так зато памяти много, зачем мне эти диски? Но сетевая
 карта как раз и стала камнем преткновения, обеспечив будущее развлечение. </li>
 <li>ping до нового сервера терял 40-50% пакетов. Чуть-чуть повозившись,
   выяснилось что проблема исключительно в сервере, то есть ping  с
   него на его же роутер приводил к тем же проблемам. </li>
</ul>

<p align="justify">Я поискал в интернете описания подобных ситуаций, осознал что всё кроется в общей
конфигурации системы: FreeBSD, конфигурация amd64, RealTek
8139. Было ясно, что если заменить любой из трёх пунктов, проблемы
с сетью решатся, но так как мне желательно FreeBSD/amd64 оставить,
то правильным решением была бы замена сетевой карты на нормальную. О
своих выводах сообщать в hcenter я не стал, просто описал возникшую
проблему и стал смотреть как они её будут решать. </p>

<p align="justify">Чуть-чуть подробнее о карте Realtek 8139. Судя по всему, она с FreeBSD вообще
не работает. В исходниках драйвера if_rl карты Realtek 8139 про неё написано
следующее: </p>
<blockquote>
 <p align="justify"><b>RealTek 8129/8139 PCI NIC driver</b></p>

 <p align="justify">Supports several extremely cheap PCI 10/100 adapters based on
 the RealTek chipset.</p>

 <p align="justify">The RealTek 8139 PCI NIC redefines the meaning of 'low end.' This is
 probably the worst PCI ethernet controller ever made, with the possible
 exception of the FEAST chip made by SMC. The 8139 supports bus-master
 DMA, but it has a terrible interface that nullifies any performance
 gains that bus-master DMA usually offers.</p>
</blockquote>

<p align="justify">Разработчики FreeBSD не стесняются в выражениях, когда
слышат про эту карту. К примеру, автор другого драйвера
realtek-овских карт, if_re, <a href="http://lists.freebsd.org/pipermail/freebsd-hardware/2004-January/000996.html">пишет</a> про чуть более качественную карту
8139C+ и 8139: </p>
<blockquote>
You are not going to find an 8139C+ NIC anywhere in the U.S. market,
except built into some higher end Compaq laptops. None of the ethernet
card makers bought the 8139C+ chip, because it costs about a dollar
more than all of the other 8139 parts. Why wouldn't they spend the
extra buck for all those added featuers and performance? Because they
know that cheap bastard consumers like you wouldn't buy it. Everyone
makes such grand claims about how they want to buy only quality hardware,
but then you go to the local computer store and what do you buy? The
cheapest thing you can find. The board makers know this, so they cater
to your idiotic whims by selling you the cheapest thing _they_ can find.
And RealTek decided to corner the market by making the cheapest chip
possible so they'd always be the board makers' first choice.
</blockquote>

<p align="justify">Таким образом, возникшие проблемы означали: </p>
<ul>
 <li>после установки операционной системы никто работоспособность
 сервера не проверял вообще. </li>
 <li>FreeBSD на эти сервера ставили, скорее всего, впервые, хотя
 возможность поставить FreeBSD у hcenter почему-то заявлена. </li>
</ul>

<p align="justify">Первый же ответ из службы технической поддержки показал, что в саппорте всё-таки работает как минимум
два студента, а не один &mdash; у меня переспросили, какой именно сервер я имею в
виду и параметры доступа к нему.</p>

<p align="justify">По той же логике, получалось что в саппорте работало и не больше чем
два студента, потому что впоследствии меня уже узнавали и без указания
сервера. Я даже думаю, что это и есть весь весь состав hcenter,
так как вопросы  менеджерского уровня решались через тот же адрес
техподдержки, и иногда ответы дублировались (то есть, они оба
занимались моей проблемой и посылали ответы сразу)</p>

<p align="justify">В основном саппорт hcenter'а брал на себя роль передатчика сообщений
между специалистами дата-центра keyweb'а и мною. Роль эту они
исполняли старательно, быстро, но иногда всё-таки мешались, если плохо
разбирались в описании проблем. То есть одновременно 
являлись и источником
шумовых помех на линии связи между мною и дата-центром. </p>

<p align="justify">&laquo;Техники дата-центра&raquo;, как их называют в hcenter'е, лишнего движения
не делают. Проблема с пингом? Не вопрос, мы поменяем сетевую
карту! Но запустить ping и проверить что пакеты перестали пропадать
они не могут. </p>

<p align="justify">Таким образом следующие несколько дней прошли так: техники имеют
доступ к железу, но делают там что-то своё; hcenter переводит письма от них
ко мне и обратно; а ping'ом из всей нашей компании владею только
я.</p> 

<p align="justify">Выглядит это так: <br /><br />
Я: ping теряет пакеты! <br />
hcenter-техникам: ping теряет пакеты! <br />
Техники: Мы поменяли карту!<br />
hcenter-мне: Техники поменяли карту!<br />
Я: ping так же теряет пакеты!<br />
hcenter-техникам: ping так же теряет пакеты!<br />
Техники: Мы заменили кабель!<br />
hcenter-мне: Техники заменили кабель!<br />
Я: ping так же теряет пакеты!<br />
hcenter-техникам: ping так же теряет пакеты!<br />
</p>

<p align="justify">В этой переписке hcenter иногда брался всё-таки проверить мои слова, но путал адреса
и мне приходилось ещё раз повторять своё письмо, додумывая по пути,
что же они могли напутать. </p>

<p align="justify">Я же, из интереса, наблюдал за действиями на сервере. Из значимых
событий можно отметить установку Midnight Commander кем-то, кто
работал с адреса из korolev.net. Midnignt Commander, тем не менее, не
помог. </p>

<p align="justify">Довольно-таки быстро возможности чего-то поменять иссякли и они
задумались. </p>

<p align="justify">И я тоже задумался &mdash; это что же за дешёвый сервер такой, в котором
можно поменять сетевую карту? Она же обычно интегрированная, да и
места в одном юните мало? И вот тут
я наконец прозрел &mdash; никакие это не сервера, а просто рабочие
станции! Я понимаю, что кому-то может показаться, что это прозрение из
разряда &laquo;деда Мороза-то нет&raquo;, но оно не было от этого менее
удивительно для меня. Я до сих пор был уверен, что рабочие станции ставить в
дата-центр просто неэффективно, они и греются иначе, и вообще не
приспособлены к тому, чтобы в большом количестве стоять в стойке... Но
тем не менее, факт остаётся фактом.</p> 

<p align="justify">Если зайти на немецкий сайт keyweb.de, <a href="http://www.keyweb.de/rz-album/rz_index.html"  rel="nofollow">постетить фото-тутр по
дата-центру</a>, то можно найти фотографию, где видно как эти
псевдо-сервера располагаются:</p>
<table align="center" border="0" cellspacing="0" cellpadding="5" width="600">
<tr><td></td></tr>
<tr><td>&nbsp;</td>
<td bgcolor="#cccccc" width="100%" nowrap>Иллюстрация</td>
</tr>
<tr><td colspan="2"></td></tr>
<tr>
<td>&nbsp;</td>
<td width="100%"><img src="/images/30_11_08.jpg" width="600" height="450" border="0" alt="Дата-центр keyweb" /></td></tr>
<tr>
<td>&nbsp;</td>
<td width="100%">
Дата-центр keyweb
</td></tr>
</table>

<p align="justify">На заднем плане видно, как можно расположить 20 ATX
корпусов в одной стойке. После этого я стал внимательнее
присматриваться к предложениям других дата-центров, сверять модели
серверов, если они их приводили. Все они, за редким исключением,
предоставляют рабочие станции. И даже тогда, когда они пишут про brand
name, обычно имеются в виду те же brand name рабочие станции, а не
сервера (хотя сетевые карты в этих случаях, вроде, получше). А ещё я
обнаружил предложения об аренде Mac Mini, на которые раньше не обращал
внимания. </p>

<p align="justify">В общем-то, это всё не страшно, если компьютеры работспособны. Но для
того, чтобы получить дешёвый сервер на выходе, они максимально
удешвеляют всё и качество в итоге страдает сильно. И если до того я
натыкался в интернете на мнения, что, мол, keyweb опитмален по
соотношению качество-цена, то теперь точно знаю: авторы этих мнений
просто не знают, что такое качество. Если ноль делить на любую ненулевую цену,
результатом будет всё равно ноль. </p>

<h2>FreeBSD 7.0</h2>

<p align="justify">В конце-концов, через неделю, 16-го ноября, мне сделали предложение, которое я не смогу
пересказать, а лучше приведу целиком (все цитаты я привожу в авторских вариантах): </p>
<blockquote>
Техники еще раз проверили сетевое оборудование, утверждают, что все в порядке, из дата-центра поступило следующее решение проблемы:
Переустановка системы - 1000 рублей, если потери на "чистой" системе будут продолжатся счет выставлен не будет.
Техники уверены, что проблема носит программный характрер, из-за некорректной работы ОС или часли ПО(драйверов) в системе.
</blockquote>

<p align="justify">Представьте себе: вам выдали неработающий сервер, после чего
предлагают, мол, мы что-нибудь сделаем, если оно заработает, то вы нам
должны. Я, конечно же, возмутился &mdash; я всегда считал, что в стоимость
установки сервера как-нибудь да входит доведение его до рабочего
состояния. А тут вдруг оказалось, что бывают и иные мнения на этот
счёт.</p> 

<p align="justify">Мы некоторое время попереписывались на эту тему, по-моему мне удалось
объяснить свою точку зрения hcenter'у и немцам. </p>

<p align="justify">В итоге ОС переставили, но вместо FreeBSD 6.3 туда установили FreeBSD
7.0, мотивируя это утверждением что 7.0 &mdash; &laquo;наиболее стабильная&raquo;. Никогда до сих
пор версии FreeBSD с номерами x.0 рабочими не были, и 7.0 здесь не
исключение. Эта версия &mdash; только начало обкатки, настоящая
стабильность, за которую FreeBSD и ценят, достигается к версиям
x.2-x.3. Соответственно, утверждение о стабильности 7.0 является ещё одним подтверждением, что опыта работы с FreeBSD ни у
keyweb'а, ни у hcenter'а нет.</p> 

<p align="justify">Тем не менее, пакеты у ping'а стали пропадать значительно реже, а
иногда вообще казалось что всё в порядке, поэтому я решил 
попробовать 7.0.  </p>

<p align="justify">Но не всё так просто. При переустановке системы то ли немцы, то ли hcenter, забыли про
требуемое разбиение диска и в итоге на диске оказался один большой корневой
раздел. Я попросил переставить систему заново, с моим разбиением на разделы, на что получил
очередной, изумительный по своей наивности ответ:</p>
<blockquote>
Создать необходимые разделы вы можете самостоятельно.
</blockquote>

<p align="justify">У меня есть опыт работы с disklabel'ом, переразбить разделы без
потери системы на новом
диске действительно можно, но зачем это делать? Это очень опасно, одна
опечатка в какой-нибудь цифре таблицы разделов приведёт к  трудно
выявляемым проблемам в будущем... </p>

<p align="justify">Так что, после очередной переписки, диск мне разбили заново. Но в этот раз забыли во время установки
сделать зеркало при помощи gmirror'а. Смотреть на этот цирк с конями
мне уже не хотелось, поэтому зеркало я поднял сам и продолжил эксперименты. </p>

<p align="justify">10 следующих дней, по 26-е число, я развлекался следующим образом: </p>

<ul>
<li> имел очередную беседу со службой поддержки о том, когда же
началось использование сервера: когда они мне передали пароль с
доступом к нему, или когда он перестал терять пакеты. В итоге,
в виде особой поблажки, мне выделили 7 дней бесплатного пользования
сервером. </li>

<li>один раз наблюдал проблемы со всей сетью дата-центра: 17-25% потерь
  пакетов до всех ресурсов в нём, не только до моего сервера. Причём, я подождал два
  часа, думая что всё исправят без меня, однако пришлось написать
  письмо в саппорт, которое передали немцам, после чего проблемы
  сразу решились (а мне больше ничего не ответили). Может быть это и
  совпадение, но я всё больше думаю что никто особенно за качеством
  соединения там не следит. </li>

<li>предложил доплатить за то, чтобы мне всё-таки поставили нормальную
  сетевую карту вместо Realtek 8139. Отказали. </li>

<li>исследовал работу с сетью. </li>
</ul>

<p align="justify">Печально, но несмотря на работу ping'а, сетевую нагрузку FreeBSD 7.0 с
этой картой не держала. Сразу
после перезагрузки из сервера можно было добыть примерно 2,5-3
мегабайта в секунду. Такая скорость держалась пару часов, после чего
начинала медленно падать и через сутки доходила до 300 килобайт в
секунду, а ещё через сутки падала до единиц килобайт в секунду. После
перезагрузки сервер опять возвращался к 2,5-3 мегабайтам. Ради очистки
совести я обновил систему до 7.1-BETA2, но ничего не помогло. </p>

<p align="justify">После чего я решил закончить мучать бедное животное, о чём и написал
в hcenter. </p>

<h2>CentOS 5.2</h2>

<p align="justify">И тут hcenter сделал неожиданный ход! Я прямо обалдел от
внезапной и неслыханной доселе щедрости. </p>

<p align="justify">Мне предложили совершенно бесплатно, то есть даром, поставить туда
какой-нибудь Linux на мой выбор. &laquo;Вот это да, вот это сервис!&raquo; подумал
я и робко поинтересовался, могут ли они вернуть деньги? Нет, деньги
они вернуть не могут, &laquo;т.к. у дата-центра нет moneyback&raquo;. </p>

<p align="justify">В известном фильме &laquo;Белое солнце пустыни&raquo; главного героя спрашивают: </p>
 <p align="justify">&mdash; Тебя быстро убить, или помучать перед смертью?</p>
<p align="justify">А тот отвечает: </p>
<p align="justify">&mdash; Лучше, конечно, помучаться. </p>
<p align="justify">Вот и я решил, что лучше будет помучаться, а вдруг действительно
именно в Linux'е и скрыта сермяжная правда? </p>

<p align="justify">Для установки ОС меня попросили ответить на вопросы: </p>
<blockquote>
OS -<br />
Disc partitions -<br />
Disc mirroring - 
</blockquote>
Я выбрал CentOS и особенно хочу обратить внимание на последний вопрос
&mdash; зеркалированиие. Конечно же да! Зеркало мне нужно построить, я так
и написал. Я вообще всегда указывал, что я хочу зеркало из двух дисков. </p> 

<p align="justify">27-го числа я получил доступ к CentOS'у. Тут нужно сделать лирическое
отступление про мои отношения с Linux'ом. Пока я работал над
Спамтестом, мне приходилось иметь дело с большим зоопарком различных
дистрибутивов Linux'а: некоторые мы поддерживали официально, ещё кучу
приходилось держать, чтобы проверять возможнось установить туда наш
продукт несмотря на отсутствие официальной поддержки. С тех пор во мне
укоренилось следующее: </p>
<ul>
 <li>каждый дистрибутив Linux'а в чём-то не похож на другой. </li>
 <li>каждый дистрибутив чем-то крив (причём кривость его особенная,
 отличающая его от других дистрибутивов). </li>
 <li>всё сделано не так, как у людей (в смысле, во FreeBSD).</li>
</ul>
<p align="justify">Работать с Linux'ом мне некомфортно, и вообще я считаю, что там много
лишнего, а какие-то вещи сделаны чрезмерно сложно. С другой
стороны, если бы у меня сложилось бы с CentOS'ом, то я бы нашёл
применение виртуализации. </p>

<p align="justify">В общем, первый же логин в предоставленную систему заставил меня вспомнить всё
про Linux. К примеру, я уж не знаю, по какой причине, но в памяти болталось
огромное количество лишних процессов, например, cupsd. У сервера не
было принтера, зачем на него был поставлен cupsd?</p>

<p align="justify">Дальше я начал разбираться, как в Linux'е теперь устроен софтверный
рейд, обнаружил что зеркало мне не собрали и попытался собрать его
самостоятельно. Здесь, кстати, опять показательна разница между
FreeBSD и Linux: </p>
<ul>
 <li>чтобы собрать gmirror на работающем сервере под управлением  FreeBSD нужно выполнить 4-5 команд. </li>
 <li>чтобы поднять зеркало на работающем сервере под Linux... нужно выполнить зеркалирование
 каждого отдельного раздела. В общем виде последовательность действий
 выглядит так: 
   <ol>
    <li>скопировать таблицу расположения разделов с первого диска на второй.</li>
    <li>собрать неполное зеркало из одного диска (второго), для каждого
    раздела &mdash; своё зеркало.</li>
    <li> подмонтировать каждый новый раздел.</li>
    <li>скопировать данные с каждого исходного раздела на
    соответствующий раздел  нового рейда. </li>
   <li>поправить загрузчик, чтобы грузиться с зеркала.</li>
   <li> перезагрузиться (загрузится с зеркала).</li>
   <li>включить в рейд старый диск, опять, по разделам. </li>
  </ol>
  Понятно, зачем это всё надо: чтобы иметь возможность часть диска с важными данными держать в зеркале, а часть пустить страйпом. 
  Но на практике использования серверов лучше всего работает полное зеркалирование, любое стремление к компромиссам (RAID-5 или 
  неполное зеркалирование) увеличивает вероятность потерь важных данных. А цена и размер дисков сейчас таковы, что если нужно
  в два раза больше места, проще купить в два раза больше дисков. То есть простой gmirror из FreeBSD логичнее, на мой взгляд, 
  сложного mdadm.
</li>
</ul>

<p align="justify">При установке системы это всё делается значительно проще: достаточно
указать что разделы должны быть в зеркале, дальше инсталлятор всё
делает сам. </p>

<p align="justify">Я решил, что попробую собрать зеркало &mdash; я же не первый, кто такое
делает, должны быть пошаговые описания, примеры? Выяснилось, однако, что
в интернете присутствует с десяток инструкций по выполнению этой
операции, каждая из которых в чём-то да отличается от другой. Я
попытался постелить везде где можно соломки, вида заргузки старого
ядра если не загрузилось новое, и эта соломка мне даже
помогла. Однако, когда я наконец правильно указал имя ядра на новом зеркале,
оно, судя по всему, загрузилось, но разделы не подмонтировало. Где-то
я в этой долгой последовательности операций допустил ошибку,
до сих пор не знаю какую. Самое простое объяснение &mdash; опечатался в fstab.
</p> 

<p align="justify">После этого я обратился снова в саппорт, с просьбой перезагрузить
сервер и во время перезагрузки выбрать второй пункт меню GRUB'а. А лучше всего переставить всё-таки систему так, как я
просил &mdash; с зеркалом, потому что во время установки сделать зеркало
забыли и это было сделать тогда проще, чем сейчас. </p>
 
<p align="justify">На это я получил следующие два ответа: </p>
<blockquote>
Настройка raid услуга платная. Цена такой услуги составляет 1100
рублей (1 такт работы техника) и производится техниками дата-центра.
</blockquote>
<p align="justify">Оказывается, рейд они не настраивают при установке (почему только
тогда первые два раза gmirror им удался?), сбор софтверного рейда &mdash;
платный. А вопрос про &laquo;Disc mirroring&raquo; мне задали на всякий случай,
так как</p>
<blockquote>
На некоторых конфигурациях серверов есть аппаратный raid, поэтому в этом пункте спрашивают включать аппаратный raid или нет.
</blockquote>

<p align="justify">Это моментально напомнило мне &laquo;Алису в стране чудес&raquo;:</p>
<blockquote>
<p align="justify">&mdash;Не хочешь ли торта? &mdash; любезно предложил Заяц.</p>
<p align="justify">Алиса оглядела весь стол, но там ничего не было, кроме чайников и чайной посуды.</p>
<p align="justify">&mdash; Какого торта? Что-то я его не вижу, &mdash; сказала она.</p>
<p align="justify">&mdash; Его тут и нет, &mdash; подтвердил Заяц.</p>
<p align="justify">&mdash; Зачем же предлагать? Это не очень-то вежливо! &mdash; обиженно сказала Алиса.</p>
</blockquote>
<p align="justify">Я вместе с Алисой тоже удивляюсь: зачем предлагать то, чего нет?</p>

<p align="justify">Общее же предложение саппорта по решению возникшей проблемы было следующим: </p>
<blockquote>
1. Проблему решает техник , стоимость работы техника составляет 1000 рублей<br />
2. Подключение kvm на 5 часов. стоимость 1200 рублей
</blockquote>
Я не стал уточнять, что конкретно стоит 1000 рублей &mdash; настройка
зеркала (а в предыдущем письме было 1100?) или просто выбор пункта
меню. </p>

<p align="justify">К этому моменту я утомился окончательно, всё-таки этот сюр
продолжается уже месяц, всё больше становилось не смешно, а
грустно.  Требование же заплатить денег
за простую операцию (выбрать пункт меню) меня никак не устраивало,
так как вдруг оказалось, что  всё то, к чему я привык у нормальных провайдеров, здесь
почему-то требует дополнительной оплаты. Кроме того, как я уже
убедился на собственном опыте, подход немецких техников к снаряду
может проблему и не решить, а дальше опять начнётся вытягивание денег.</p>

<p align="justify">Так что на этом я решил окончательно завершить своё общение со всей
этой убогой компанией. В принципе,
единственное о чём я жалею, это то что я не
проверил работу сети под CentOS'ом перед настройкой зеркала. Мне показалось, что
через сутки бесперерывной работы опять начались странные лаги, но, как известно, &laquo;когда кажется &mdash; креститься надо&raquo;,
я вполне допускаю что  драйвера Linux'а для Realtek 8139 лучше
FreeBSD-шных аналогов, но не имею доказательств.</p> 

<p align="justify">Для меня хождение в Германию оказалось полезным. Если раньше я ещё
как-то сомневался, думал из-за постоянной нехватки места в Москве о
возможности переноса части сервисов (я уже не личный сервер имею в
виду, а рабочие машины) куда-нибудь в иностранные дата-центры,
надеясь что там будет дешевле, лучше и проще, то теперь я не сомневаюсь:
нормальное качество аренды и обслуживания будет стоить дорого и,
скорее всего, дороже московских услуг даже с учётом имеющихся проблем с
электричеством и связанных с этим ростом цен. То есть, теперь я уверен, что
установка своих серверов в арендованную стойку в Москве выгоднее и
надёжнее, чем аренда этих же серверов в Европе. </p>

<p align="justify">А то, как работает hcenter и keyweb это просто смешно. Впрочем, я
давно хотел завести себе блог, вернее, восстановить его в новом
качестве. Думал, что когда перееду на новое место, тогда и подниму. На
новое место я не переехал, а вот хорошая тема для записи в блог уже
появилась, за что, коечно, нужно быть благодарным этим компаниям. </p>

<h2>PS</h2>
<p align="justify">Перечитав всё, долго думал &mdash; что же мне всё это напоминает? Ах,
да, приключения Лебедева и Мумусика в казахстанских степях. Не в тех
масштабах, но общие ощущения схожие. Так что, если хочется экстрима,
совершенно необязательно ехать за тридевять земель &mdash; достаточно
арендовать дешёвый сервер в Германии!</p>




<h2>Ссылки по теме</h2>


<table width="100%" border="0" cellspacing="0" cellpadding="5">
<tr><td><a href="http://webhostingtalk.ru/" target="_blank">http://webhostingtalk.ru/</a></td>
<td width="100%">
 Форум о веб-хостинге.
</td></tr>
<tr><td><a href="http://hostobzor.ru" target="_blank">http://hostobzor.ru</a></td>
<td width="100%">
 Хостобзор: отзывы о провайдерах. .
</td></tr>
</table>


<hr>
&copy;2000-2001 by Andrey L. Kalinin, 
<a href="http://counter.rambler.ru/top100/" alt="Rambler's Top100" target="_blank"><img align=right src="http://images.rambler.ru/top100/banner-88x31-rambler-black2.gif" border=0 width=88 height=31></a>
<br>
andrey@kalinin.ru
</body>
</html>
